[{"data":1,"prerenderedAt":3008},["ShallowReactive",2],{"navigation":3,"docs-/ecosystem/nuxt/ssr-pm2-deploy":290,"surround-/ecosystem/nuxt/ssr-pm2-deploy":3005},[4,147,227],{"title":5,"description":6,"icon":7,"path":8,"stem":9,"children":10,"page":28},"语言与生态","按语言、框架与工具分类整理，聚焦实践要点与可复用知识。","i-lucide-folder-code","/ecosystem","0.ecosystem",[11,29,46,58,70,87,118,130],{"title":12,"description":13,"icon":14,"path":15,"stem":16,"children":17,"page":28},"JavaScript","JavaScript 基础语法、异步编程和框架使用。","i-tabler-brand-javascript","/ecosystem/javascript","0.ecosystem/0.javascript",[18,23],{"title":19,"path":20,"stem":21,"description":22},"异步编程","/ecosystem/javascript/async-await","0.ecosystem/0.javascript/async-await","深入理解 Promise 和 async/await 异步编程模式",{"title":24,"path":25,"stem":26,"description":27},"网络请求","/ecosystem/javascript/fetch","0.ecosystem/0.javascript/fetch","使用 fetch API 进行网络请求和数据交互",false,{"title":30,"description":31,"icon":32,"path":33,"stem":34,"children":35,"page":28},"样式技术","CSS 和预处理器的高级特性和最佳实践","i-mdi-palette-outline","/ecosystem/styles","0.ecosystem/1.styles",[36,41],{"title":37,"path":38,"stem":39,"description":40},"CSS 高级特性","/ecosystem/styles/css","0.ecosystem/1.styles/css","CSS 变量、Flexbox 响应式布局等现代 CSS 特性",{"title":42,"path":43,"stem":44,"description":45},"Sass 预处理器","/ecosystem/styles/sass","0.ecosystem/1.styles/sass","Sass 模块化、构建工具配置和弃用警告处理",{"title":47,"description":48,"icon":49,"path":50,"stem":51,"children":52,"page":28},"TypeScript","TypeScript 的类型系统、接口、泛型等内容。","i-tabler-brand-typescript","/ecosystem/typescript","0.ecosystem/2.typescript",[53],{"title":54,"path":55,"stem":56,"description":57},"全局变量","/ecosystem/typescript/declare-global","0.ecosystem/2.typescript/declare-global","在 TypeScript 中使用全局类型。",{"title":59,"description":60,"icon":61,"path":62,"stem":63,"children":64,"page":28},"Vue","Vue.js 框架及其生态系统的使用指南和最佳实践。","i-tabler-brand-vue","/ecosystem/vue","0.ecosystem/3.vue",[65],{"title":66,"path":67,"stem":68,"description":69},"踩坑笔记","/ecosystem/vue/issues","0.ecosystem/3.vue/issues","记录 Vue 开发过程中遇到的问题和解决方案。",{"title":71,"description":72,"icon":73,"path":74,"stem":75,"children":76,"page":28},"Vite","Vite 是一个现代化的构建工具，它提供了快速的开发体验和高效的构建性能。","i-tabler-brand-vite","/ecosystem/vite","0.ecosystem/4.vite",[77,82],{"title":78,"path":79,"stem":80,"description":81},"按需自动导入","/ecosystem/vite/auto-import","0.ecosystem/4.vite/auto-import","组件、API 和图标按需自动导入，简化代码并提升开发效率。",{"title":83,"path":84,"stem":85,"description":86},"Vite 资源导入","/ecosystem/vite/resources-import","0.ecosystem/4.vite/resources-import","Vite 提供了多种灵活的静态资源导入方式，无需手动管理文件路径。",{"title":88,"description":89,"icon":90,"path":91,"stem":92,"children":93,"page":28},"Nuxt","Nuxt 是一个基于 Vue 的通用框架，用于构建服务器端渲染 (SSR) 和静态站点应用程序。","i-tabler-brand-nuxt","/ecosystem/nuxt","0.ecosystem/5.nuxt",[94,99,103,108,113],{"title":95,"path":96,"stem":97,"description":98},"Copy Page","/ecosystem/nuxt/copy-page","0.ecosystem/5.nuxt/copy-page","为用户与 LLM 提供「干净的 Markdown 原文」，可直接复制或在新标签页查看。",{"title":66,"path":100,"stem":101,"description":102},"/ecosystem/nuxt/issues","0.ecosystem/5.nuxt/issues","记录 Nuxt 开发过程中遇到的问题和解决方案。",{"title":104,"path":105,"stem":106,"description":107},"Nuxt LLMs","/ecosystem/nuxt/llms","0.ecosystem/5.nuxt/llms","使用 nuxt-llms 生成 /llms.txt，并规范化站内链接以便 LLM 抓取。",{"title":109,"path":110,"stem":111,"description":112},"Nuxt SEO","/ecosystem/nuxt/nuxt-seo","0.ecosystem/5.nuxt/nuxt-seo","Nuxt SEO 实战配置指南",{"title":114,"path":115,"stem":116,"description":117},"Nuxt SSR + PM2 部署","/ecosystem/nuxt/ssr-pm2-deploy","0.ecosystem/5.nuxt/ssr-pm2-deploy","在 Ubuntu 上使用 PM2 集群模式部署 Nuxt SSR，并通过 Nginx（Docker）反向代理与 Cloudflare 前置加速。",{"title":119,"description":120,"icon":121,"path":122,"stem":123,"children":124,"page":28},"UI 组件库","常用的 UI 组件库。","i-lucide-library","/ecosystem/ui-libraries","0.ecosystem/6.ui-libraries",[125],{"title":126,"path":127,"stem":128,"description":129},"Element Plus","/ecosystem/ui-libraries/element-plus","0.ecosystem/6.ui-libraries/element-plus","在使用 Element Plus 组件库时遇到的常见问题及其解决方案。",{"title":131,"description":132,"icon":133,"path":134,"stem":135,"children":136,"page":28},"Java","记录我在 Java 与相关框架中的理解与踩坑，包括语言基础、JVM、并发、Spring、构建与测试等。","i-mdi-language-java","/ecosystem/java","0.ecosystem/7.java",[137,142],{"title":138,"path":139,"stem":140,"description":141},"全局依赖缓存位置","/ecosystem/java/global-cache","0.ecosystem/7.java/global-cache","说明 Maven 与 Gradle 全局依赖缓存位置",{"title":143,"path":144,"stem":145,"description":146},"安装 Java 与构建工具","/ecosystem/java/mac-install","0.ecosystem/7.java/mac-install","如何使用 Homebrew 在 macOS 上安装和管理多个 Java 版本。",{"title":148,"description":149,"icon":150,"path":151,"stem":152,"children":153,"page":28},"实践指南","从环境部署到平台开发的实践指南。","i-lucide-rocket","/guides","1.guides",[154,176,193,215],{"title":155,"description":156,"icon":157,"path":158,"stem":159,"children":160,"page":28},"环境部署","Docker、PostgreSQL 和 DigitalOcean 的部署指南。","i-lucide-server","/guides/deployment","1.guides/deployment",[161,166,171],{"title":162,"path":163,"stem":164,"description":165},"DigitalOcean","/guides/deployment/digitalocean","1.guides/deployment/digitalocean","DigitalOcean 使用指南",{"title":167,"path":168,"stem":169,"description":170},"Docker","/guides/deployment/docker","1.guides/deployment/docker","Docker 安装和使用指南",{"title":172,"path":173,"stem":174,"description":175},"PostgreSQL 部署","/guides/deployment/postgresql-guide","1.guides/deployment/postgresql-guide","使用 Docker Compose 部署 PostgreSQL",{"title":177,"description":178,"icon":179,"path":180,"stem":181,"children":182,"page":28},"操作系统","macOS 和 Linux 的环境配置。","i-lucide-laptop","/guides/os","1.guides/os",[183,188],{"title":184,"path":185,"stem":186,"description":187},"Linux","/guides/os/linux","1.guides/os/linux","Linux 常用命令、服务器管理、开发环境配置等",{"title":189,"path":190,"stem":191,"description":192},"macOS","/guides/os/macos","1.guides/os/macos","记录一次 Mac 环境配置",{"title":194,"description":195,"icon":196,"path":197,"stem":198,"children":199,"page":28},"平台开发","浙政钉和 iServer 等平台的开发实践。","i-lucide-tv-minimal","/guides/platforms","1.guides/platforms",[200,205,210],{"title":201,"path":202,"stem":203,"description":204},"浙政钉开发","/guides/platforms/dingtalk","1.guides/platforms/dingtalk","浙政钉开发实用技巧",{"title":206,"path":207,"stem":208,"description":209},"GitLab CI/CD 完全指南","/guides/platforms/gitlab-ci","1.guides/platforms/gitlab-ci","一份涵盖从入门、配置到问题排查的完整 CI/CD 实践文档，实现快速上手并高效利用自动化流水线。",{"title":211,"path":212,"stem":213,"description":214},"IServer 踩坑归集","/guides/platforms/iserver","1.guides/platforms/iserver","超图服务调用踩坑归集",{"title":216,"description":217,"icon":218,"path":219,"stem":220,"children":221,"page":28},"运行时环境","Node.js、Java 等运行时环境的配置和使用指南。","i-lucide-router","/guides/runtime","1.guides/runtime",[222],{"title":223,"path":224,"stem":225,"description":226},"Node","/guides/runtime/node","1.guides/runtime/node","Node 的配置和使用指南。",{"title":228,"description":229,"icon":230,"path":231,"stem":232,"children":233,"page":28},"工具集","开发过程中常用工具的配置和使用指南。","i-lucide-wrench","/tools","2.tools",[234,256,273],{"title":235,"description":236,"icon":237,"path":238,"stem":239,"children":240,"page":28},"IDE 编辑器","编辑器的配置和使用指南。","i-lucide-monitor","/tools/editors","2.tools/editors",[241,246,251],{"title":242,"path":243,"stem":244,"description":245},"Cursor","/tools/editors/.cursor","2.tools/editors/.cursor","Cursor 的使用、配置和插件指南",{"title":247,"path":248,"stem":249,"description":250},"IntelliJ IDEA","/tools/editors/idea","2.tools/editors/idea","在 macOS 上安装和配置 IntelliJ IDEA，优化你的 Java 开发环境。",{"title":252,"path":253,"stem":254,"description":255},"VS Code","/tools/editors/vscode","2.tools/editors/vscode","VS Code 的配置和使用指南。",{"title":257,"description":258,"icon":259,"path":260,"stem":261,"children":262,"page":28},"包管理器","Homebrew 和 pnpm 等包管理器的使用。","i-lucide-hammer","/tools/package-managers","2.tools/package-managers",[263,268],{"title":264,"path":265,"stem":266,"description":267},"Homebrew","/tools/package-managers/homebrew","2.tools/package-managers/homebrew","Homebrew 的配置和使用指南。",{"title":269,"path":270,"stem":271,"description":272},"Pnpm","/tools/package-managers/pnpm","2.tools/package-managers/pnpm","pnpm 的配置和使用指南。",{"title":274,"description":275,"icon":276,"path":277,"stem":278,"children":279,"page":28},"版本控制","Git 和 fnm 等版本控制工具的配置和使用。","i-lucide-git-branch","/tools/version-control","2.tools/version-control",[280,285],{"title":281,"path":282,"stem":283,"description":284},"Fnm","/tools/version-control/fnm","2.tools/version-control/fnm","fnm 的安装、配置、使用、常见问题等。",{"title":286,"path":287,"stem":288,"description":289},"Git","/tools/version-control/git","2.tools/version-control/git","Git 的配置、使用、常见问题等。",{"id":291,"title":114,"body":292,"description":117,"extension":2999,"head":3000,"links":3000,"meta":3001,"navigation":480,"ogImage":3000,"path":115,"schemaOrg":3000,"seo":3002,"sitemap":3003,"stem":116,"__hash__":3004},"docs/0.ecosystem/5.nuxt/ssr-pm2-deploy.md",{"type":293,"value":294,"toc":2984},"minimark",[295,299,331,351,361,364,705,709,714,721,867,870,933,936,961,965,971,1233,1236,1263,1267,1286,2848,2852,2862,2918,2921,2927,2942,2948,2951,2974,2980],[296,297,298],"h2",{"id":298},"前置要求与架构说明",[300,301,302,310,325],"ul",{},[303,304,305,309],"li",{},[306,307,308],"strong",{},"部署目标","：本项目以 SSR 方式运行，主站由 Nginx（Docker）反代至 Node 服务（PM2 集群托管）。",[303,311,312,315,316,320,321,324],{},[306,313,314],{},"监听策略","：Node 监听 ",[317,318,319],"code",{},"0.0.0.0:3000","（容器通过 ",[317,322,323],{},"host.docker.internal"," 访问宿主机端口）。",[303,326,327,330],{},[306,328,329],{},"域名与 CDN","：域名走 Cloudflare，需关闭 Rocket Loader/Mirage/Email Obfuscation 以避免注入脚本导致水合异常。",[332,333,335],"note",{"to":334},"https://nuxt.com/docs/4.x/getting-started/deployment#nodejs-server",[336,337,338,339,342,343,346,347,350],"p",{},"参考 Nuxt 官方文档（Node.js Server 入口：",[317,340,341],{},"node .output/server/index.mjs","，可用 ",[317,344,345],{},"HOST/PORT"," 或 ",[317,348,349],{},"NITRO_HOST/NITRO_PORT"," 控制）。",[332,352,354],{"to":353},"https://pm2.keymetrics.io/docs/usage/quick-start/",[336,355,356,357,360],{},"参考 PM2 官方文档（集群模式 ",[317,358,359],{},"instances: 'max'","，守护、日志、开机自启、零停机重载）。",[296,362,363],{"id":363},"服务器环境准备",[365,366,368,373,380,445,452,456,459,494,498,539,649,653],"steps",{"level":367},"3",[369,370,372],"h3",{"id":371},"安装-pm2","安装 PM2",[374,375,377],"tip",{"to":376},"/guides/runtime/node#直接下载安装",[336,378,379],{},"在 Linux 上安装 Node 22、pnpm 请参考 Node.js 安装指南",[381,382,387],"pre",{"className":383,"code":384,"filename":385,"language":385,"meta":386,"style":386},"language-sh shiki shiki-themes material-theme-lighter github-light github-dark monokai","# 安装\nnpm i -g pm2\n# 查看 pm2 版本\npm2 --version\n# 查看 pm2 状态\npm2 status\n","sh","",[317,388,389,398,416,422,431,437],{"__ignoreMap":386},[390,391,394],"span",{"class":392,"line":393},"line",1,[390,395,397],{"class":396},"ss7Ak","# 安装\n",[390,399,401,405,409,413],{"class":392,"line":400},2,[390,402,404],{"class":403},"sR7ES","npm",[390,406,408],{"class":407},"sLACW"," i",[390,410,412],{"class":411},"sFhLe"," -g",[390,414,415],{"class":407}," pm2\n",[390,417,419],{"class":392,"line":418},3,[390,420,421],{"class":396},"# 查看 pm2 版本\n",[390,423,425,428],{"class":392,"line":424},4,[390,426,427],{"class":403},"pm2",[390,429,430],{"class":411}," --version\n",[390,432,434],{"class":392,"line":433},5,[390,435,436],{"class":396},"# 查看 pm2 状态\n",[390,438,440,442],{"class":392,"line":439},6,[390,441,427],{"class":403},[390,443,444],{"class":407}," status\n",[336,446,447],{},[448,449],"img",{"alt":450,"src":451},"验证 PM2 版本","/images/ecosystem/nuxt/verify-pm2.png",[369,453,455],{"id":454},"配置-pm2-开机自启","配置 PM2 开机自启",[336,457,458],{},"为确保服务器重启后应用自动恢复，需要配置 PM2 开机自启：",[381,460,462],{"className":383,"code":461,"filename":385,"language":385,"meta":386,"style":386},"# 1. 生成并配置启动脚本\npm2 startup\n\n# 2. 保存当前进程列表\npm2 save\n",[317,463,464,469,476,482,487],{"__ignoreMap":386},[390,465,466],{"class":392,"line":393},[390,467,468],{"class":396},"# 1. 生成并配置启动脚本\n",[390,470,471,473],{"class":392,"line":400},[390,472,427],{"class":403},[390,474,475],{"class":407}," startup\n",[390,477,478],{"class":392,"line":418},[390,479,481],{"emptyLinePlaceholder":480},true,"\n",[390,483,484],{"class":392,"line":424},[390,485,486],{"class":396},"# 2. 保存当前进程列表\n",[390,488,489,491],{"class":392,"line":433},[390,490,427],{"class":403},[390,492,493],{"class":407}," save\n",[369,495,497],{"id":496},"验证-pm2-自启配置","验证 PM2 自启配置",[381,499,501],{"className":383,"code":500,"filename":385,"language":385,"meta":386,"style":386},"# 测试重启后恢复\nsudo reboot\n\n# 重启后检查应用状态\npm2 list\npm2 logs\n",[317,502,503,508,516,520,525,532],{"__ignoreMap":386},[390,504,505],{"class":392,"line":393},[390,506,507],{"class":396},"# 测试重启后恢复\n",[390,509,510,513],{"class":392,"line":400},[390,511,512],{"class":403},"sudo",[390,514,515],{"class":407}," reboot\n",[390,517,518],{"class":392,"line":418},[390,519,481],{"emptyLinePlaceholder":480},[390,521,522],{"class":392,"line":424},[390,523,524],{"class":396},"# 重启后检查应用状态\n",[390,526,527,529],{"class":392,"line":433},[390,528,427],{"class":403},[390,530,531],{"class":407}," list\n",[390,533,534,536],{"class":392,"line":439},[390,535,427],{"class":403},[390,537,538],{"class":407}," logs\n",[540,541,542,551,556,568,573,624,629],"warning",{},[336,543,544,550],{},[306,545,546,549],{},[317,547,548],{},"pm2 startup"," 行为说明","：",[336,552,553,550],{},[306,554,555],{},"Root 用户",[300,557,558,561],{},[303,559,560],{},"PM2 会自动配置系统服务，无需手动执行额外命令",[303,562,563,564,567],{},"直接创建 ",[317,565,566],{},"/etc/systemd/system/pm2-root.service"," 并启用",[336,569,570,550],{},[306,571,572],{},"普通用户",[300,574,575,578],{},[303,576,577],{},"PM2 会输出需要手动执行的 sudo 命令",[303,579,580,581],{},"需要复制完整的 sudo 命令并执行，例如：\n",[381,582,584],{"className":383,"code":583,"language":385,"meta":386,"style":386},"sudo env PATH=$PATH:/usr/bin /usr/local/lib/node_modules/pm2/bin/pm2 startup systemd -u username --hp /home/username\n",[317,585,586],{"__ignoreMap":386},[390,587,588,590,593,596,600,603,606,609,612,615,618,621],{"class":392,"line":393},[390,589,512],{"class":403},[390,591,592],{"class":407}," env",[390,594,595],{"class":407}," PATH=",[390,597,599],{"class":598},"ss--_","$PATH",[390,601,602],{"class":407},":/usr/bin",[390,604,605],{"class":407}," /usr/local/lib/node_modules/pm2/bin/pm2",[390,607,608],{"class":407}," startup",[390,610,611],{"class":407}," systemd",[390,613,614],{"class":411}," -u",[390,616,617],{"class":407}," username",[390,619,620],{"class":411}," --hp",[390,622,623],{"class":407}," /home/username\n",[336,625,626,550],{},[306,627,628],{},"通用注意事项",[300,630,631,636,642],{},[303,632,633,635],{},[317,634,548],{}," 只需在服务器初次配置时执行一次",[303,637,638,641],{},[317,639,640],{},"pm2 save"," 在每次应用更新后执行，保持进程列表同步",[303,643,644,645,648],{},"使用 ",[317,646,647],{},"pm2 unstartup systemd"," 可以移除开机自启配置",[369,650,652],{"id":651},"可选ufw-防火墙策略","（可选）UFW 防火墙策略",[381,654,656],{"className":383,"code":655,"filename":385,"language":385,"meta":386,"style":386},"sudo ufw allow 22/tcp\nsudo ufw allow 80/tcp\nsudo ufw allow 443/tcp\nsudo ufw deny 3000/tcp\n",[317,657,658,671,682,693],{"__ignoreMap":386},[390,659,660,662,665,668],{"class":392,"line":393},[390,661,512],{"class":403},[390,663,664],{"class":407}," ufw",[390,666,667],{"class":407}," allow",[390,669,670],{"class":407}," 22/tcp\n",[390,672,673,675,677,679],{"class":392,"line":400},[390,674,512],{"class":403},[390,676,664],{"class":407},[390,678,667],{"class":407},[390,680,681],{"class":407}," 80/tcp\n",[390,683,684,686,688,690],{"class":392,"line":418},[390,685,512],{"class":403},[390,687,664],{"class":407},[390,689,667],{"class":407},[390,691,692],{"class":407}," 443/tcp\n",[390,694,695,697,699,702],{"class":392,"line":424},[390,696,512],{"class":403},[390,698,664],{"class":407},[390,700,701],{"class":407}," deny",[390,703,704],{"class":407}," 3000/tcp\n",[296,706,708],{"id":707},"nginxdocker反代至-node宿主机","Nginx（Docker）反代至 Node（宿主机）",[374,710,711],{"to":168},[336,712,713],{},"参考 Docker 安装和使用指南",[336,715,716,717,720],{},"确保 ",[317,718,719],{},"docker-compose.yml"," 已配置：",[381,722,726],{"className":723,"code":724,"filename":719,"language":725,"meta":386,"style":386},"language-yml shiki shiki-themes material-theme-lighter github-light github-dark monokai","services:\n  nginx:\n    image: nginx:latest\n    container_name: my-nginx\n    ports:\n      - \"80:80\"\n      - \"443:443\"\n    volumes:\n      - ./nginx/default.conf:/etc/nginx/conf.d/default.conf:ro\n      - ./html:/usr/share/nginx/html:ro\n      - ./etc/ssl:/etc/ssl:ro\n    extra_hosts:\n      - \"host.docker.internal:host-gateway\" # 添加这一行，用于容器内访问宿主机端口\n    restart: unless-stopped\n","yml",[317,727,728,738,745,756,766,773,788,800,808,816,824,832,840,856],{"__ignoreMap":386},[390,729,730,734],{"class":392,"line":393},[390,731,733],{"class":732},"sHsBP","services",[390,735,737],{"class":736},"swvn1",":\n",[390,739,740,743],{"class":392,"line":400},[390,741,742],{"class":732},"  nginx",[390,744,737],{"class":736},[390,746,747,750,753],{"class":392,"line":418},[390,748,749],{"class":732},"    image",[390,751,752],{"class":736},":",[390,754,755],{"class":407}," nginx:latest\n",[390,757,758,761,763],{"class":392,"line":424},[390,759,760],{"class":732},"    container_name",[390,762,752],{"class":736},[390,764,765],{"class":407}," my-nginx\n",[390,767,768,771],{"class":392,"line":433},[390,769,770],{"class":732},"    ports",[390,772,737],{"class":736},[390,774,775,778,782,785],{"class":392,"line":439},[390,776,777],{"class":736},"      -",[390,779,781],{"class":780},"siCPE"," \"",[390,783,784],{"class":407},"80:80",[390,786,787],{"class":780},"\"\n",[390,789,791,793,795,798],{"class":392,"line":790},7,[390,792,777],{"class":736},[390,794,781],{"class":780},[390,796,797],{"class":407},"443:443",[390,799,787],{"class":780},[390,801,803,806],{"class":392,"line":802},8,[390,804,805],{"class":732},"    volumes",[390,807,737],{"class":736},[390,809,811,813],{"class":392,"line":810},9,[390,812,777],{"class":736},[390,814,815],{"class":407}," ./nginx/default.conf:/etc/nginx/conf.d/default.conf:ro\n",[390,817,819,821],{"class":392,"line":818},10,[390,820,777],{"class":736},[390,822,823],{"class":407}," ./html:/usr/share/nginx/html:ro\n",[390,825,827,829],{"class":392,"line":826},11,[390,828,777],{"class":736},[390,830,831],{"class":407}," ./etc/ssl:/etc/ssl:ro\n",[390,833,835,838],{"class":392,"line":834},12,[390,836,837],{"class":732},"    extra_hosts",[390,839,737],{"class":736},[390,841,843,845,847,850,853],{"class":392,"line":842},13,[390,844,777],{"class":736},[390,846,781],{"class":780},[390,848,849],{"class":407},"host.docker.internal:host-gateway",[390,851,852],{"class":780},"\"",[390,854,855],{"class":396}," # 添加这一行，用于容器内访问宿主机端口\n",[390,857,859,862,864],{"class":392,"line":858},14,[390,860,861],{"class":732},"    restart",[390,863,752],{"class":736},[390,865,866],{"class":407}," unless-stopped\n",[336,868,869],{},"将主站从静态目录切换为反代 Node ：",[381,871,876],{"className":872,"code":873,"filename":874,"language":875,"meta":386,"style":386},"language-conf shiki shiki-themes material-theme-lighter github-light github-dark monokai","server {\n    # 主站改为反代到 Node SSR\n    location / {\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n        proxy_pass http://host.docker.internal:3000;\n    }\n}\n","nginx/default.conf","conf",[317,877,878,883,888,893,898,903,908,913,918,923,928],{"__ignoreMap":386},[390,879,880],{"class":392,"line":393},[390,881,882],{},"server {\n",[390,884,885],{"class":392,"line":400},[390,886,887],{},"    # 主站改为反代到 Node SSR\n",[390,889,890],{"class":392,"line":418},[390,891,892],{},"    location / {\n",[390,894,895],{"class":392,"line":424},[390,896,897],{},"        proxy_http_version 1.1;\n",[390,899,900],{"class":392,"line":433},[390,901,902],{},"        proxy_set_header Host $host;\n",[390,904,905],{"class":392,"line":439},[390,906,907],{},"        proxy_set_header X-Real-IP $remote_addr;\n",[390,909,910],{"class":392,"line":790},[390,911,912],{},"        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n",[390,914,915],{"class":392,"line":802},[390,916,917],{},"        proxy_set_header X-Forwarded-Proto $scheme;\n",[390,919,920],{"class":392,"line":810},[390,921,922],{},"        proxy_pass http://host.docker.internal:3000;\n",[390,924,925],{"class":392,"line":818},[390,926,927],{},"    }\n",[390,929,930],{"class":392,"line":826},[390,931,932],{},"}\n",[336,934,935],{},"重启：",[381,937,939],{"className":383,"code":938,"filename":385,"language":385,"meta":386,"style":386},"docker compose -f /root/my-nginx/docker-compose.yml restart nginx\n",[317,940,941],{"__ignoreMap":386},[390,942,943,946,949,952,955,958],{"class":392,"line":393},[390,944,945],{"class":403},"docker",[390,947,948],{"class":407}," compose",[390,950,951],{"class":411}," -f",[390,953,954],{"class":407}," /root/my-nginx/docker-compose.yml",[390,956,957],{"class":407}," restart",[390,959,960],{"class":407}," nginx\n",[296,962,964],{"id":963},"pm2-配置集群模式","PM2 配置（集群模式）",[336,966,967,968,550],{},"在项目根目录新增 ",[317,969,970],{},"ecosystem.config.cjs",[381,972,976],{"className":973,"code":974,"filename":970,"language":975,"meta":386,"style":386},"language-js shiki shiki-themes material-theme-lighter github-light github-dark monokai","module.exports = {\n  apps: [\n    {\n      name: 'mhaibaraai.cn',\n      script: './.output/server/index.mjs',\n      exec_mode: 'cluster',\n      instances: 'max',\n      env: {\n        HOST: '0.0.0.0',\n        PORT: '3000',\n        NITRO_HOST: '0.0.0.0',\n        NITRO_PORT: '3000'\n      },\n      max_memory_restart: '512M',\n      out_file: './.pm2/out.log',\n      error_file: './.pm2/error.log',\n      time: true\n    }\n  ]\n}\n","js",[317,977,978,997,1008,1013,1032,1048,1064,1080,1089,1105,1121,1136,1150,1155,1171,1188,1205,1217,1222,1228],{"__ignoreMap":386},[390,979,980,984,987,990,994],{"class":392,"line":393},[390,981,983],{"class":982},"saDeg","module",[390,985,986],{"class":736},".",[390,988,989],{"class":982},"exports",[390,991,993],{"class":992},"sGXK2"," =",[390,995,996],{"class":736}," {\n",[390,998,999,1003,1005],{"class":392,"line":400},[390,1000,1002],{"class":1001},"squCx","  apps",[390,1004,752],{"class":736},[390,1006,1007],{"class":598}," [\n",[390,1009,1010],{"class":392,"line":418},[390,1011,1012],{"class":736},"    {\n",[390,1014,1015,1018,1020,1023,1026,1029],{"class":392,"line":424},[390,1016,1017],{"class":1001},"      name",[390,1019,752],{"class":736},[390,1021,1022],{"class":780}," '",[390,1024,1025],{"class":407},"mhaibaraai.cn",[390,1027,1028],{"class":780},"'",[390,1030,1031],{"class":736},",\n",[390,1033,1034,1037,1039,1041,1044,1046],{"class":392,"line":433},[390,1035,1036],{"class":1001},"      script",[390,1038,752],{"class":736},[390,1040,1022],{"class":780},[390,1042,1043],{"class":407},"./.output/server/index.mjs",[390,1045,1028],{"class":780},[390,1047,1031],{"class":736},[390,1049,1050,1053,1055,1057,1060,1062],{"class":392,"line":439},[390,1051,1052],{"class":1001},"      exec_mode",[390,1054,752],{"class":736},[390,1056,1022],{"class":780},[390,1058,1059],{"class":407},"cluster",[390,1061,1028],{"class":780},[390,1063,1031],{"class":736},[390,1065,1066,1069,1071,1073,1076,1078],{"class":392,"line":790},[390,1067,1068],{"class":1001},"      instances",[390,1070,752],{"class":736},[390,1072,1022],{"class":780},[390,1074,1075],{"class":407},"max",[390,1077,1028],{"class":780},[390,1079,1031],{"class":736},[390,1081,1082,1085,1087],{"class":392,"line":802},[390,1083,1084],{"class":1001},"      env",[390,1086,752],{"class":736},[390,1088,996],{"class":736},[390,1090,1091,1094,1096,1098,1101,1103],{"class":392,"line":810},[390,1092,1093],{"class":1001},"        HOST",[390,1095,752],{"class":736},[390,1097,1022],{"class":780},[390,1099,1100],{"class":407},"0.0.0.0",[390,1102,1028],{"class":780},[390,1104,1031],{"class":736},[390,1106,1107,1110,1112,1114,1117,1119],{"class":392,"line":818},[390,1108,1109],{"class":1001},"        PORT",[390,1111,752],{"class":736},[390,1113,1022],{"class":780},[390,1115,1116],{"class":407},"3000",[390,1118,1028],{"class":780},[390,1120,1031],{"class":736},[390,1122,1123,1126,1128,1130,1132,1134],{"class":392,"line":826},[390,1124,1125],{"class":1001},"        NITRO_HOST",[390,1127,752],{"class":736},[390,1129,1022],{"class":780},[390,1131,1100],{"class":407},[390,1133,1028],{"class":780},[390,1135,1031],{"class":736},[390,1137,1138,1141,1143,1145,1147],{"class":392,"line":834},[390,1139,1140],{"class":1001},"        NITRO_PORT",[390,1142,752],{"class":736},[390,1144,1022],{"class":780},[390,1146,1116],{"class":407},[390,1148,1149],{"class":780},"'\n",[390,1151,1152],{"class":392,"line":842},[390,1153,1154],{"class":736},"      },\n",[390,1156,1157,1160,1162,1164,1167,1169],{"class":392,"line":858},[390,1158,1159],{"class":1001},"      max_memory_restart",[390,1161,752],{"class":736},[390,1163,1022],{"class":780},[390,1165,1166],{"class":407},"512M",[390,1168,1028],{"class":780},[390,1170,1031],{"class":736},[390,1172,1174,1177,1179,1181,1184,1186],{"class":392,"line":1173},15,[390,1175,1176],{"class":1001},"      out_file",[390,1178,752],{"class":736},[390,1180,1022],{"class":780},[390,1182,1183],{"class":407},"./.pm2/out.log",[390,1185,1028],{"class":780},[390,1187,1031],{"class":736},[390,1189,1191,1194,1196,1198,1201,1203],{"class":392,"line":1190},16,[390,1192,1193],{"class":1001},"      error_file",[390,1195,752],{"class":736},[390,1197,1022],{"class":780},[390,1199,1200],{"class":407},"./.pm2/error.log",[390,1202,1028],{"class":780},[390,1204,1031],{"class":736},[390,1206,1208,1211,1213],{"class":392,"line":1207},17,[390,1209,1210],{"class":1001},"      time",[390,1212,752],{"class":736},[390,1214,1216],{"class":1215},"s8HiA"," true\n",[390,1218,1220],{"class":392,"line":1219},18,[390,1221,927],{"class":736},[390,1223,1225],{"class":392,"line":1224},19,[390,1226,1227],{"class":598},"  ]\n",[390,1229,1231],{"class":392,"line":1230},20,[390,1232,932],{"class":736},[336,1234,1235],{},"首启与持久化：",[381,1237,1239],{"className":383,"code":1238,"filename":385,"language":385,"meta":386,"style":386},"pm2 start ecosystem.config.cjs\npm2 save\npm2 startup\n",[317,1240,1241,1251,1257],{"__ignoreMap":386},[390,1242,1243,1245,1248],{"class":392,"line":393},[390,1244,427],{"class":403},[390,1246,1247],{"class":407}," start",[390,1249,1250],{"class":407}," ecosystem.config.cjs\n",[390,1252,1253,1255],{"class":392,"line":400},[390,1254,427],{"class":403},[390,1256,493],{"class":407},[390,1258,1259,1261],{"class":392,"line":418},[390,1260,427],{"class":403},[390,1262,475],{"class":407},[296,1264,1266],{"id":1265},"github-actionsci与-ssh-发布","GitHub Actions（CI）与 SSH 发布",[332,1268,1269,1272],{},[336,1270,1271],{},"CI Secrets 最小集，其余参数在工作流中直接定义：",[300,1273,1274,1280],{},[303,1275,1276,1279],{},[317,1277,1278],{},"SSH_PRIVATE_KEY"," - SSH 私钥",[303,1281,1282,1285],{},[317,1283,1284],{},"SSH_HOST"," - SSH 主机",[1287,1288,1289],"code-collapse",{},[1290,1291,1292,1916],"code-group",{},[381,1293,1296],{"className":723,"code":1294,"filename":1295,"language":725,"meta":386,"style":386},"name: Deploy\n\non:\n  push:\n    branches:\n      - main\n\njobs:\n  deploy:\n    runs-on: ubuntu-latest\n    env:\n      NODE_OPTIONS: --max_old_space_size=4096\n\n    permissions:\n      contents: write\n      id-token: write\n\n    steps:\n      - uses: actions/checkout@v5\n        with:\n          fetch-depth: 0\n\n      - uses: pnpm/action-setup@v4\n\n      - name: Setup Node.js\n        uses: actions/setup-node@v4\n        with:\n          node-version: lts/*\n          cache: pnpm\n\n      - name: Install dependencies\n        run: pnpm install --frozen-lockfile\n\n      - name: Prepare build\n        run: pnpm run dev:prepare\n\n      - name: Run build (SSR)\n        run: pnpm run build\n\n      - name: Setup SSH agent\n        uses: webfactory/ssh-agent@v0.9.1\n        with:\n          ssh-private-key: |\n            ${{ secrets.SSH_PRIVATE_KEY }}\n\n      - name: Add known_hosts\n        env:\n          SSH_HOST: ${{ secrets.SSH_HOST }}\n          SSH_PORT: 22\n        run: |\n          mkdir -p ~/.ssh\n          ssh-keyscan -H \"$SSH_HOST\" -p \"$SSH_PORT\" >> ~/.ssh/known_hosts\n\n      - name: Deploy to server via SSH\n        env:\n          SSH_USER: root\n          SSH_HOST: ${{ secrets.SSH_HOST }}\n          SSH_PORT: 22\n          DEPLOY_DIR: /root/my-nginx/html/www/mhaibaraai.cn\n          PM2_APP_NAME: mhaibaraai.cn\n        run: |\n          bash scripts/deploy.sh\n\n      - name: Deploy build artifacts to gh-pages\n        uses: peaceiris/actions-gh-pages@v4\n        with:\n          github_token: ${{ secrets.GITHUB_TOKEN }}\n          publish_dir: ./.output\n          publish_branch: gh-pages\n          force_orphan: true\n          commit_message: 'chore(release): build artifacts'\n",".github/workflows/deploy.yml",[317,1297,1298,1308,1312,1319,1326,1333,1340,1344,1351,1358,1368,1375,1385,1389,1396,1406,1415,1419,1426,1438,1445,1457,1462,1474,1479,1492,1503,1510,1521,1532,1537,1549,1560,1565,1577,1587,1592,1604,1614,1619,1631,1641,1648,1660,1666,1671,1683,1691,1702,1713,1722,1728,1734,1739,1751,1758,1769,1778,1787,1798,1809,1818,1824,1829,1841,1851,1858,1869,1880,1891,1901],{"__ignoreMap":386},[390,1299,1300,1303,1305],{"class":392,"line":393},[390,1301,1302],{"class":732},"name",[390,1304,752],{"class":736},[390,1306,1307],{"class":407}," Deploy\n",[390,1309,1310],{"class":392,"line":400},[390,1311,481],{"emptyLinePlaceholder":480},[390,1313,1314,1317],{"class":392,"line":418},[390,1315,1316],{"class":1215},"on",[390,1318,737],{"class":736},[390,1320,1321,1324],{"class":392,"line":424},[390,1322,1323],{"class":732},"  push",[390,1325,737],{"class":736},[390,1327,1328,1331],{"class":392,"line":433},[390,1329,1330],{"class":732},"    branches",[390,1332,737],{"class":736},[390,1334,1335,1337],{"class":392,"line":439},[390,1336,777],{"class":736},[390,1338,1339],{"class":407}," main\n",[390,1341,1342],{"class":392,"line":790},[390,1343,481],{"emptyLinePlaceholder":480},[390,1345,1346,1349],{"class":392,"line":802},[390,1347,1348],{"class":732},"jobs",[390,1350,737],{"class":736},[390,1352,1353,1356],{"class":392,"line":810},[390,1354,1355],{"class":732},"  deploy",[390,1357,737],{"class":736},[390,1359,1360,1363,1365],{"class":392,"line":818},[390,1361,1362],{"class":732},"    runs-on",[390,1364,752],{"class":736},[390,1366,1367],{"class":407}," ubuntu-latest\n",[390,1369,1370,1373],{"class":392,"line":826},[390,1371,1372],{"class":732},"    env",[390,1374,737],{"class":736},[390,1376,1377,1380,1382],{"class":392,"line":834},[390,1378,1379],{"class":732},"      NODE_OPTIONS",[390,1381,752],{"class":736},[390,1383,1384],{"class":407}," --max_old_space_size=4096\n",[390,1386,1387],{"class":392,"line":842},[390,1388,481],{"emptyLinePlaceholder":480},[390,1390,1391,1394],{"class":392,"line":858},[390,1392,1393],{"class":732},"    permissions",[390,1395,737],{"class":736},[390,1397,1398,1401,1403],{"class":392,"line":1173},[390,1399,1400],{"class":732},"      contents",[390,1402,752],{"class":736},[390,1404,1405],{"class":407}," write\n",[390,1407,1408,1411,1413],{"class":392,"line":1190},[390,1409,1410],{"class":732},"      id-token",[390,1412,752],{"class":736},[390,1414,1405],{"class":407},[390,1416,1417],{"class":392,"line":1207},[390,1418,481],{"emptyLinePlaceholder":480},[390,1420,1421,1424],{"class":392,"line":1219},[390,1422,1423],{"class":732},"    steps",[390,1425,737],{"class":736},[390,1427,1428,1430,1433,1435],{"class":392,"line":1224},[390,1429,777],{"class":736},[390,1431,1432],{"class":732}," uses",[390,1434,752],{"class":736},[390,1436,1437],{"class":407}," actions/checkout@v5\n",[390,1439,1440,1443],{"class":392,"line":1230},[390,1441,1442],{"class":732},"        with",[390,1444,737],{"class":736},[390,1446,1448,1451,1453],{"class":392,"line":1447},21,[390,1449,1450],{"class":732},"          fetch-depth",[390,1452,752],{"class":736},[390,1454,1456],{"class":1455},"sYThS"," 0\n",[390,1458,1460],{"class":392,"line":1459},22,[390,1461,481],{"emptyLinePlaceholder":480},[390,1463,1465,1467,1469,1471],{"class":392,"line":1464},23,[390,1466,777],{"class":736},[390,1468,1432],{"class":732},[390,1470,752],{"class":736},[390,1472,1473],{"class":407}," pnpm/action-setup@v4\n",[390,1475,1477],{"class":392,"line":1476},24,[390,1478,481],{"emptyLinePlaceholder":480},[390,1480,1482,1484,1487,1489],{"class":392,"line":1481},25,[390,1483,777],{"class":736},[390,1485,1486],{"class":732}," name",[390,1488,752],{"class":736},[390,1490,1491],{"class":407}," Setup Node.js\n",[390,1493,1495,1498,1500],{"class":392,"line":1494},26,[390,1496,1497],{"class":732},"        uses",[390,1499,752],{"class":736},[390,1501,1502],{"class":407}," actions/setup-node@v4\n",[390,1504,1506,1508],{"class":392,"line":1505},27,[390,1507,1442],{"class":732},[390,1509,737],{"class":736},[390,1511,1513,1516,1518],{"class":392,"line":1512},28,[390,1514,1515],{"class":732},"          node-version",[390,1517,752],{"class":736},[390,1519,1520],{"class":407}," lts/*\n",[390,1522,1524,1527,1529],{"class":392,"line":1523},29,[390,1525,1526],{"class":732},"          cache",[390,1528,752],{"class":736},[390,1530,1531],{"class":407}," pnpm\n",[390,1533,1535],{"class":392,"line":1534},30,[390,1536,481],{"emptyLinePlaceholder":480},[390,1538,1540,1542,1544,1546],{"class":392,"line":1539},31,[390,1541,777],{"class":736},[390,1543,1486],{"class":732},[390,1545,752],{"class":736},[390,1547,1548],{"class":407}," Install dependencies\n",[390,1550,1552,1555,1557],{"class":392,"line":1551},32,[390,1553,1554],{"class":732},"        run",[390,1556,752],{"class":736},[390,1558,1559],{"class":407}," pnpm install --frozen-lockfile\n",[390,1561,1563],{"class":392,"line":1562},33,[390,1564,481],{"emptyLinePlaceholder":480},[390,1566,1568,1570,1572,1574],{"class":392,"line":1567},34,[390,1569,777],{"class":736},[390,1571,1486],{"class":732},[390,1573,752],{"class":736},[390,1575,1576],{"class":407}," Prepare build\n",[390,1578,1580,1582,1584],{"class":392,"line":1579},35,[390,1581,1554],{"class":732},[390,1583,752],{"class":736},[390,1585,1586],{"class":407}," pnpm run dev:prepare\n",[390,1588,1590],{"class":392,"line":1589},36,[390,1591,481],{"emptyLinePlaceholder":480},[390,1593,1595,1597,1599,1601],{"class":392,"line":1594},37,[390,1596,777],{"class":736},[390,1598,1486],{"class":732},[390,1600,752],{"class":736},[390,1602,1603],{"class":407}," Run build (SSR)\n",[390,1605,1607,1609,1611],{"class":392,"line":1606},38,[390,1608,1554],{"class":732},[390,1610,752],{"class":736},[390,1612,1613],{"class":407}," pnpm run build\n",[390,1615,1617],{"class":392,"line":1616},39,[390,1618,481],{"emptyLinePlaceholder":480},[390,1620,1622,1624,1626,1628],{"class":392,"line":1621},40,[390,1623,777],{"class":736},[390,1625,1486],{"class":732},[390,1627,752],{"class":736},[390,1629,1630],{"class":407}," Setup SSH agent\n",[390,1632,1634,1636,1638],{"class":392,"line":1633},41,[390,1635,1497],{"class":732},[390,1637,752],{"class":736},[390,1639,1640],{"class":407}," webfactory/ssh-agent@v0.9.1\n",[390,1642,1644,1646],{"class":392,"line":1643},42,[390,1645,1442],{"class":732},[390,1647,737],{"class":736},[390,1649,1651,1654,1656],{"class":392,"line":1650},43,[390,1652,1653],{"class":732},"          ssh-private-key",[390,1655,752],{"class":736},[390,1657,1659],{"class":1658},"sRxSC"," |\n",[390,1661,1663],{"class":392,"line":1662},44,[390,1664,1665],{"class":407},"            ${{ secrets.SSH_PRIVATE_KEY }}\n",[390,1667,1669],{"class":392,"line":1668},45,[390,1670,481],{"emptyLinePlaceholder":480},[390,1672,1674,1676,1678,1680],{"class":392,"line":1673},46,[390,1675,777],{"class":736},[390,1677,1486],{"class":732},[390,1679,752],{"class":736},[390,1681,1682],{"class":407}," Add known_hosts\n",[390,1684,1686,1689],{"class":392,"line":1685},47,[390,1687,1688],{"class":732},"        env",[390,1690,737],{"class":736},[390,1692,1694,1697,1699],{"class":392,"line":1693},48,[390,1695,1696],{"class":732},"          SSH_HOST",[390,1698,752],{"class":736},[390,1700,1701],{"class":407}," ${{ secrets.SSH_HOST }}\n",[390,1703,1705,1708,1710],{"class":392,"line":1704},49,[390,1706,1707],{"class":732},"          SSH_PORT",[390,1709,752],{"class":736},[390,1711,1712],{"class":1455}," 22\n",[390,1714,1716,1718,1720],{"class":392,"line":1715},50,[390,1717,1554],{"class":732},[390,1719,752],{"class":736},[390,1721,1659],{"class":1658},[390,1723,1725],{"class":392,"line":1724},51,[390,1726,1727],{"class":407},"          mkdir -p ~/.ssh\n",[390,1729,1731],{"class":392,"line":1730},52,[390,1732,1733],{"class":407},"          ssh-keyscan -H \"$SSH_HOST\" -p \"$SSH_PORT\" >> ~/.ssh/known_hosts\n",[390,1735,1737],{"class":392,"line":1736},53,[390,1738,481],{"emptyLinePlaceholder":480},[390,1740,1742,1744,1746,1748],{"class":392,"line":1741},54,[390,1743,777],{"class":736},[390,1745,1486],{"class":732},[390,1747,752],{"class":736},[390,1749,1750],{"class":407}," Deploy to server via SSH\n",[390,1752,1754,1756],{"class":392,"line":1753},55,[390,1755,1688],{"class":732},[390,1757,737],{"class":736},[390,1759,1761,1764,1766],{"class":392,"line":1760},56,[390,1762,1763],{"class":732},"          SSH_USER",[390,1765,752],{"class":736},[390,1767,1768],{"class":407}," root\n",[390,1770,1772,1774,1776],{"class":392,"line":1771},57,[390,1773,1696],{"class":732},[390,1775,752],{"class":736},[390,1777,1701],{"class":407},[390,1779,1781,1783,1785],{"class":392,"line":1780},58,[390,1782,1707],{"class":732},[390,1784,752],{"class":736},[390,1786,1712],{"class":1455},[390,1788,1790,1793,1795],{"class":392,"line":1789},59,[390,1791,1792],{"class":732},"          DEPLOY_DIR",[390,1794,752],{"class":736},[390,1796,1797],{"class":407}," /root/my-nginx/html/www/mhaibaraai.cn\n",[390,1799,1801,1804,1806],{"class":392,"line":1800},60,[390,1802,1803],{"class":732},"          PM2_APP_NAME",[390,1805,752],{"class":736},[390,1807,1808],{"class":407}," mhaibaraai.cn\n",[390,1810,1812,1814,1816],{"class":392,"line":1811},61,[390,1813,1554],{"class":732},[390,1815,752],{"class":736},[390,1817,1659],{"class":1658},[390,1819,1821],{"class":392,"line":1820},62,[390,1822,1823],{"class":407},"          bash scripts/deploy.sh\n",[390,1825,1827],{"class":392,"line":1826},63,[390,1828,481],{"emptyLinePlaceholder":480},[390,1830,1832,1834,1836,1838],{"class":392,"line":1831},64,[390,1833,777],{"class":736},[390,1835,1486],{"class":732},[390,1837,752],{"class":736},[390,1839,1840],{"class":407}," Deploy build artifacts to gh-pages\n",[390,1842,1844,1846,1848],{"class":392,"line":1843},65,[390,1845,1497],{"class":732},[390,1847,752],{"class":736},[390,1849,1850],{"class":407}," peaceiris/actions-gh-pages@v4\n",[390,1852,1854,1856],{"class":392,"line":1853},66,[390,1855,1442],{"class":732},[390,1857,737],{"class":736},[390,1859,1861,1864,1866],{"class":392,"line":1860},67,[390,1862,1863],{"class":732},"          github_token",[390,1865,752],{"class":736},[390,1867,1868],{"class":407}," ${{ secrets.GITHUB_TOKEN }}\n",[390,1870,1872,1875,1877],{"class":392,"line":1871},68,[390,1873,1874],{"class":732},"          publish_dir",[390,1876,752],{"class":736},[390,1878,1879],{"class":407}," ./.output\n",[390,1881,1883,1886,1888],{"class":392,"line":1882},69,[390,1884,1885],{"class":732},"          publish_branch",[390,1887,752],{"class":736},[390,1889,1890],{"class":407}," gh-pages\n",[390,1892,1894,1897,1899],{"class":392,"line":1893},70,[390,1895,1896],{"class":732},"          force_orphan",[390,1898,752],{"class":736},[390,1900,1216],{"class":1215},[390,1902,1904,1907,1909,1911,1914],{"class":392,"line":1903},71,[390,1905,1906],{"class":732},"          commit_message",[390,1908,752],{"class":736},[390,1910,1022],{"class":780},[390,1912,1913],{"class":407},"chore(release): build artifacts",[390,1915,1149],{"class":780},[381,1917,1920],{"className":383,"code":1918,"filename":1919,"language":385,"meta":386,"style":386},"#!/usr/bin/env bash\nset -euo pipefail\n\n# Required envs from GitHub Actions\nSSH_USER=\"${SSH_USER:?missing}\"\nSSH_HOST=\"${SSH_HOST:?missing}\"\nSSH_PORT=\"${SSH_PORT:?missing}\"\nDEPLOY_DIR=\"${DEPLOY_DIR:?missing}\"\nPM2_APP_NAME=\"${PM2_APP_NAME:-nuxt-app}\"\n\n# Fixed deploy directory (no releases)\necho \"[deploy] Host=${SSH_USER}@${SSH_HOST}:${SSH_PORT}\"\necho \"[deploy] Target dir=${DEPLOY_DIR}\"\n\n# Local safety checks\n[ -n \"${DEPLOY_DIR:-}\" ] || { echo \"[deploy] DEPLOY_DIR empty\" >&2; exit 2; }\nTARGET_DIR=\"${DEPLOY_DIR%/}/.output\"\nif [ -z \"$TARGET_DIR\" ] || [ \"$TARGET_DIR\" = \"/\" ] || [ \"$(basename -- \"$TARGET_DIR\")\" != \".output\" ]; then\n  echo \"[deploy] invalid TARGET_DIR='$TARGET_DIR'\" >&2\n  exit 3\nfi\nif [ ! -d ./.output ] || [ -z \"$(ls -A ./.output 2>/dev/null || true)\" ]; then\n  echo \"[deploy] local ./.output missing or empty\" >&2\n  exit 4\nfi\n\n# Connection options\nSSH_OPTS=\"-p ${SSH_PORT}\"\nRSYNC_SSH=\"ssh ${SSH_OPTS}\"\n\n# Ensure pm2 directory exists later in remote block; create .output via rsync\n\n# Sync only built artifacts and PM2 ecosystem file\nRSYNC_PATH=\"mkdir -p '${DEPLOY_DIR%/}/.output' && rsync\"\nrsync -az --delete-after -e \"${RSYNC_SSH}\" --rsync-path \"${RSYNC_PATH}\" ./.output/ \"${SSH_USER}@${SSH_HOST}\":\"${DEPLOY_DIR%/}/.output/\"\nrsync -az -e \"${RSYNC_SSH}\" ./ecosystem.config.cjs \"${SSH_USER}@${SSH_HOST}\":\"${DEPLOY_DIR}/ecosystem.config.cjs\"\n\n# Remote pm2 reload/start (no install/build)\nssh ${SSH_OPTS} \"${SSH_USER}@${SSH_HOST}\" \"export DEPLOY_DIR='${DEPLOY_DIR}' PM2_APP_NAME='${PM2_APP_NAME}'; bash -s\" \u003C\u003C'REMOTE_EOF'\nset -eo pipefail\n\nexport NODE_OPTIONS=--max_old_space_size=1024\nexport PATH=\"/usr/local/bin:/usr/bin:/bin:$PATH\"\n\n# Resolve Node/npm global prefix bin without relying on interactive shells\nPREFIX_BIN=\"\"\nif command -v npm >/dev/null 2>&1; then\n  PREFIX_BIN=\"$(npm config get prefix 2>/dev/null)/bin\"\nelif [ -d \"$HOME/.local/share/fnm/node-versions\" ]; then\n  # Fallback: pick the newest installed node version directory\n  LATEST_NODE_DIR=\"$(ls -1dt \"$HOME/.local/share/fnm/node-versions\"/*/installation 2>/dev/null | head -n 1 || true)\"\n  [ -n \"$LATEST_NODE_DIR\" ] && PREFIX_BIN=\"$LATEST_NODE_DIR/bin\"\nfi\n[ -z \"$PREFIX_BIN\" ] && PREFIX_BIN=\"/usr/local/bin\"\nexport PATH=\"$PREFIX_BIN:$PATH\"\n\necho \"[remote] prefix bin: $PREFIX_BIN\"\n\n# Locate pm2\nPM2_BIN=\"$(command -v pm2 || true)\"\nif [ -z \"$PM2_BIN\" ]; then\n  echo \"[remote] pm2 not found\" >&2\n  exit 127\nfi\n\necho \"[remote] using pm2: $PM2_BIN\"\n\ncd \"${DEPLOY_DIR}\"\nmkdir -p .pm2\n\necho \"[remote] PM2 operation for $PM2_APP_NAME...\"\nif \"$PM2_BIN\" describe \"$PM2_APP_NAME\" >/dev/null 2>&1; then\n  \"$PM2_BIN\" reload \"$PM2_APP_NAME\" --update-env\nelse\n  PM2_APP_NAME=\"$PM2_APP_NAME\" \"$PM2_BIN\" start ecosystem.config.cjs\n  \"$PM2_BIN\" save\nfi\n\n\"$PM2_BIN\" status | cat\nREMOTE_EOF\n\necho \"[deploy] Completed\"\n","scripts/deploy.sh",[317,1921,1922,1927,1939,1943,1948,1970,1986,2003,2020,2039,2043,2048,2083,2098,2102,2107,2161,2182,2259,2278,2286,2291,2344,2357,2364,2368,2372,2377,2395,2413,2417,2422,2426,2431,2456,2517,2561,2565,2570,2628,2633,2637,2642,2647,2651,2656,2661,2666,2671,2676,2681,2686,2691,2695,2700,2705,2709,2714,2718,2723,2728,2733,2738,2743,2747,2751,2756,2760,2765,2770,2774,2779,2785,2791,2797,2803,2809,2814,2819,2825,2831,2836],{"__ignoreMap":386},[390,1923,1924],{"class":392,"line":393},[390,1925,1926],{"class":396},"#!/usr/bin/env bash\n",[390,1928,1929,1933,1936],{"class":392,"line":400},[390,1930,1932],{"class":1931},"sMLJd","set",[390,1934,1935],{"class":411}," -euo",[390,1937,1938],{"class":407}," pipefail\n",[390,1940,1941],{"class":392,"line":418},[390,1942,481],{"emptyLinePlaceholder":480},[390,1944,1945],{"class":392,"line":424},[390,1946,1947],{"class":396},"# Required envs from GitHub Actions\n",[390,1949,1950,1953,1956,1959,1961,1964,1967],{"class":392,"line":433},[390,1951,1952],{"class":598},"SSH_USER",[390,1954,1955],{"class":992},"=",[390,1957,1958],{"class":780},"\"${",[390,1960,1952],{"class":598},[390,1962,1963],{"class":992},":?",[390,1965,1966],{"class":598},"missing",[390,1968,1969],{"class":780},"}\"\n",[390,1971,1972,1974,1976,1978,1980,1982,1984],{"class":392,"line":439},[390,1973,1284],{"class":598},[390,1975,1955],{"class":992},[390,1977,1958],{"class":780},[390,1979,1284],{"class":598},[390,1981,1963],{"class":992},[390,1983,1966],{"class":598},[390,1985,1969],{"class":780},[390,1987,1988,1991,1993,1995,1997,1999,2001],{"class":392,"line":790},[390,1989,1990],{"class":598},"SSH_PORT",[390,1992,1955],{"class":992},[390,1994,1958],{"class":780},[390,1996,1990],{"class":598},[390,1998,1963],{"class":992},[390,2000,1966],{"class":598},[390,2002,1969],{"class":780},[390,2004,2005,2008,2010,2012,2014,2016,2018],{"class":392,"line":802},[390,2006,2007],{"class":598},"DEPLOY_DIR",[390,2009,1955],{"class":992},[390,2011,1958],{"class":780},[390,2013,2007],{"class":598},[390,2015,1963],{"class":992},[390,2017,1966],{"class":598},[390,2019,1969],{"class":780},[390,2021,2022,2025,2027,2029,2031,2034,2037],{"class":392,"line":810},[390,2023,2024],{"class":598},"PM2_APP_NAME",[390,2026,1955],{"class":992},[390,2028,1958],{"class":780},[390,2030,2024],{"class":598},[390,2032,2033],{"class":992},":-",[390,2035,2036],{"class":598},"nuxt-app",[390,2038,1969],{"class":780},[390,2040,2041],{"class":392,"line":818},[390,2042,481],{"emptyLinePlaceholder":480},[390,2044,2045],{"class":392,"line":826},[390,2046,2047],{"class":396},"# Fixed deploy directory (no releases)\n",[390,2049,2050,2053,2055,2058,2061,2063,2066,2069,2071,2073,2075,2077,2079,2081],{"class":392,"line":834},[390,2051,2052],{"class":1931},"echo",[390,2054,781],{"class":780},[390,2056,2057],{"class":407},"[deploy] Host=",[390,2059,2060],{"class":780},"${",[390,2062,1952],{"class":598},[390,2064,2065],{"class":780},"}",[390,2067,2068],{"class":407},"@",[390,2070,2060],{"class":780},[390,2072,1284],{"class":598},[390,2074,2065],{"class":780},[390,2076,752],{"class":407},[390,2078,2060],{"class":780},[390,2080,1990],{"class":598},[390,2082,1969],{"class":780},[390,2084,2085,2087,2089,2092,2094,2096],{"class":392,"line":842},[390,2086,2052],{"class":1931},[390,2088,781],{"class":780},[390,2090,2091],{"class":407},"[deploy] Target dir=",[390,2093,2060],{"class":780},[390,2095,2007],{"class":598},[390,2097,1969],{"class":780},[390,2099,2100],{"class":392,"line":858},[390,2101,481],{"emptyLinePlaceholder":480},[390,2103,2104],{"class":392,"line":1173},[390,2105,2106],{"class":396},"# Local safety checks\n",[390,2108,2109,2112,2115,2118,2120,2122,2125,2128,2131,2134,2137,2139,2142,2144,2147,2150,2153,2156,2158],{"class":392,"line":1190},[390,2110,2111],{"class":736},"[",[390,2113,2114],{"class":992}," -n",[390,2116,2117],{"class":780}," \"${",[390,2119,2007],{"class":598},[390,2121,2033],{"class":992},[390,2123,2124],{"class":780},"}\"",[390,2126,2127],{"class":736}," ]",[390,2129,2130],{"class":992}," ||",[390,2132,2133],{"class":736}," {",[390,2135,2136],{"class":1931}," echo",[390,2138,781],{"class":780},[390,2140,2141],{"class":407},"[deploy] DEPLOY_DIR empty",[390,2143,852],{"class":780},[390,2145,2146],{"class":992}," >&2",[390,2148,2149],{"class":736},";",[390,2151,2152],{"class":1931}," exit",[390,2154,2155],{"class":1455}," 2",[390,2157,2149],{"class":736},[390,2159,2160],{"class":736}," }\n",[390,2162,2163,2166,2168,2170,2172,2175,2177,2180],{"class":392,"line":1207},[390,2164,2165],{"class":598},"TARGET_DIR",[390,2167,1955],{"class":992},[390,2169,1958],{"class":780},[390,2171,2007],{"class":598},[390,2173,2174],{"class":992},"%/",[390,2176,2065],{"class":780},[390,2178,2179],{"class":407},"/.output",[390,2181,787],{"class":780},[390,2183,2184,2187,2190,2193,2195,2198,2200,2202,2204,2206,2208,2210,2212,2214,2216,2219,2221,2223,2225,2227,2230,2233,2236,2238,2240,2243,2246,2248,2251,2253,2256],{"class":392,"line":1219},[390,2185,2186],{"class":1658},"if",[390,2188,2189],{"class":736}," [",[390,2191,2192],{"class":992}," -z",[390,2194,781],{"class":780},[390,2196,2197],{"class":598},"$TARGET_DIR",[390,2199,852],{"class":780},[390,2201,2127],{"class":736},[390,2203,2130],{"class":992},[390,2205,2189],{"class":736},[390,2207,781],{"class":780},[390,2209,2197],{"class":598},[390,2211,852],{"class":780},[390,2213,993],{"class":992},[390,2215,781],{"class":780},[390,2217,2218],{"class":407},"/",[390,2220,852],{"class":780},[390,2222,2127],{"class":736},[390,2224,2130],{"class":992},[390,2226,2189],{"class":736},[390,2228,2229],{"class":780}," \"$(",[390,2231,2232],{"class":403},"basename",[390,2234,2235],{"class":411}," --",[390,2237,781],{"class":780},[390,2239,2197],{"class":598},[390,2241,2242],{"class":780},"\")\"",[390,2244,2245],{"class":992}," !=",[390,2247,781],{"class":780},[390,2249,2250],{"class":407},".output",[390,2252,852],{"class":780},[390,2254,2255],{"class":736}," ];",[390,2257,2258],{"class":1658}," then\n",[390,2260,2261,2264,2266,2269,2271,2273,2275],{"class":392,"line":1224},[390,2262,2263],{"class":1931},"  echo",[390,2265,781],{"class":780},[390,2267,2268],{"class":407},"[deploy] invalid TARGET_DIR='",[390,2270,2197],{"class":598},[390,2272,1028],{"class":407},[390,2274,852],{"class":780},[390,2276,2277],{"class":992}," >&2\n",[390,2279,2280,2283],{"class":392,"line":1230},[390,2281,2282],{"class":1931},"  exit",[390,2284,2285],{"class":1455}," 3\n",[390,2287,2288],{"class":392,"line":1447},[390,2289,2290],{"class":1658},"fi\n",[390,2292,2293,2295,2297,2300,2303,2306,2309,2311,2313,2315,2317,2320,2323,2325,2328,2331,2334,2337,2340,2342],{"class":392,"line":1459},[390,2294,2186],{"class":1658},[390,2296,2189],{"class":736},[390,2298,2299],{"class":992}," !",[390,2301,2302],{"class":992}," -d",[390,2304,2305],{"class":598}," ./.output ",[390,2307,2308],{"class":736},"]",[390,2310,2130],{"class":992},[390,2312,2189],{"class":736},[390,2314,2192],{"class":992},[390,2316,2229],{"class":780},[390,2318,2319],{"class":403},"ls",[390,2321,2322],{"class":411}," -A",[390,2324,2305],{"class":407},[390,2326,2327],{"class":992},"2>",[390,2329,2330],{"class":407},"/dev/null ",[390,2332,2333],{"class":992},"||",[390,2335,2336],{"class":1931}," true",[390,2338,2339],{"class":780},")\"",[390,2341,2255],{"class":736},[390,2343,2258],{"class":1658},[390,2345,2346,2348,2350,2353,2355],{"class":392,"line":1464},[390,2347,2263],{"class":1931},[390,2349,781],{"class":780},[390,2351,2352],{"class":407},"[deploy] local ./.output missing or empty",[390,2354,852],{"class":780},[390,2356,2277],{"class":992},[390,2358,2359,2361],{"class":392,"line":1476},[390,2360,2282],{"class":1931},[390,2362,2363],{"class":1455}," 4\n",[390,2365,2366],{"class":392,"line":1481},[390,2367,2290],{"class":1658},[390,2369,2370],{"class":392,"line":1494},[390,2371,481],{"emptyLinePlaceholder":480},[390,2373,2374],{"class":392,"line":1505},[390,2375,2376],{"class":396},"# Connection options\n",[390,2378,2379,2382,2384,2386,2389,2391,2393],{"class":392,"line":1512},[390,2380,2381],{"class":598},"SSH_OPTS",[390,2383,1955],{"class":992},[390,2385,852],{"class":780},[390,2387,2388],{"class":407},"-p ",[390,2390,2060],{"class":780},[390,2392,1990],{"class":598},[390,2394,1969],{"class":780},[390,2396,2397,2400,2402,2404,2407,2409,2411],{"class":392,"line":1523},[390,2398,2399],{"class":598},"RSYNC_SSH",[390,2401,1955],{"class":992},[390,2403,852],{"class":780},[390,2405,2406],{"class":407},"ssh ",[390,2408,2060],{"class":780},[390,2410,2381],{"class":598},[390,2412,1969],{"class":780},[390,2414,2415],{"class":392,"line":1534},[390,2416,481],{"emptyLinePlaceholder":480},[390,2418,2419],{"class":392,"line":1539},[390,2420,2421],{"class":396},"# Ensure pm2 directory exists later in remote block; create .output via rsync\n",[390,2423,2424],{"class":392,"line":1551},[390,2425,481],{"emptyLinePlaceholder":480},[390,2427,2428],{"class":392,"line":1562},[390,2429,2430],{"class":396},"# Sync only built artifacts and PM2 ecosystem file\n",[390,2432,2433,2436,2438,2440,2443,2445,2447,2449,2451,2454],{"class":392,"line":1567},[390,2434,2435],{"class":598},"RSYNC_PATH",[390,2437,1955],{"class":992},[390,2439,852],{"class":780},[390,2441,2442],{"class":407},"mkdir -p '",[390,2444,2060],{"class":780},[390,2446,2007],{"class":598},[390,2448,2174],{"class":992},[390,2450,2065],{"class":780},[390,2452,2453],{"class":407},"/.output' && rsync",[390,2455,787],{"class":780},[390,2457,2458,2461,2464,2467,2470,2472,2474,2476,2479,2481,2483,2485,2488,2490,2492,2494,2496,2498,2500,2502,2504,2506,2508,2510,2512,2515],{"class":392,"line":1579},[390,2459,2460],{"class":403},"rsync",[390,2462,2463],{"class":411}," -az",[390,2465,2466],{"class":411}," --delete-after",[390,2468,2469],{"class":411}," -e",[390,2471,2117],{"class":780},[390,2473,2399],{"class":598},[390,2475,2124],{"class":780},[390,2477,2478],{"class":411}," --rsync-path",[390,2480,2117],{"class":780},[390,2482,2435],{"class":598},[390,2484,2124],{"class":780},[390,2486,2487],{"class":407}," ./.output/",[390,2489,2117],{"class":780},[390,2491,1952],{"class":598},[390,2493,2065],{"class":780},[390,2495,2068],{"class":407},[390,2497,2060],{"class":780},[390,2499,1284],{"class":598},[390,2501,2124],{"class":780},[390,2503,752],{"class":407},[390,2505,1958],{"class":780},[390,2507,2007],{"class":598},[390,2509,2174],{"class":992},[390,2511,2065],{"class":780},[390,2513,2514],{"class":407},"/.output/",[390,2516,787],{"class":780},[390,2518,2519,2521,2523,2525,2527,2529,2531,2534,2536,2538,2540,2542,2544,2546,2548,2550,2552,2554,2556,2559],{"class":392,"line":1589},[390,2520,2460],{"class":403},[390,2522,2463],{"class":411},[390,2524,2469],{"class":411},[390,2526,2117],{"class":780},[390,2528,2399],{"class":598},[390,2530,2124],{"class":780},[390,2532,2533],{"class":407}," ./ecosystem.config.cjs",[390,2535,2117],{"class":780},[390,2537,1952],{"class":598},[390,2539,2065],{"class":780},[390,2541,2068],{"class":407},[390,2543,2060],{"class":780},[390,2545,1284],{"class":598},[390,2547,2124],{"class":780},[390,2549,752],{"class":407},[390,2551,1958],{"class":780},[390,2553,2007],{"class":598},[390,2555,2065],{"class":780},[390,2557,2558],{"class":407},"/ecosystem.config.cjs",[390,2560,787],{"class":780},[390,2562,2563],{"class":392,"line":1594},[390,2564,481],{"emptyLinePlaceholder":480},[390,2566,2567],{"class":392,"line":1606},[390,2568,2569],{"class":396},"# Remote pm2 reload/start (no install/build)\n",[390,2571,2572,2575,2578,2580,2582,2584,2586,2588,2590,2592,2594,2596,2598,2601,2603,2605,2607,2610,2612,2614,2616,2619,2621,2624],{"class":392,"line":1616},[390,2573,2574],{"class":403},"ssh",[390,2576,2577],{"class":736}," ${",[390,2579,2381],{"class":598},[390,2581,2065],{"class":736},[390,2583,2117],{"class":780},[390,2585,1952],{"class":598},[390,2587,2065],{"class":780},[390,2589,2068],{"class":407},[390,2591,2060],{"class":780},[390,2593,1284],{"class":598},[390,2595,2124],{"class":780},[390,2597,781],{"class":780},[390,2599,2600],{"class":407},"export DEPLOY_DIR='",[390,2602,2060],{"class":780},[390,2604,2007],{"class":598},[390,2606,2065],{"class":780},[390,2608,2609],{"class":407},"' PM2_APP_NAME='",[390,2611,2060],{"class":780},[390,2613,2024],{"class":598},[390,2615,2065],{"class":780},[390,2617,2618],{"class":407},"'; bash -s",[390,2620,852],{"class":780},[390,2622,2623],{"class":992}," \u003C\u003C",[390,2625,2627],{"class":2626},"s00De","'REMOTE_EOF'\n",[390,2629,2630],{"class":392,"line":1621},[390,2631,2632],{"class":407},"set -eo pipefail\n",[390,2634,2635],{"class":392,"line":1633},[390,2636,481],{"emptyLinePlaceholder":480},[390,2638,2639],{"class":392,"line":1643},[390,2640,2641],{"class":407},"export NODE_OPTIONS=--max_old_space_size=1024\n",[390,2643,2644],{"class":392,"line":1650},[390,2645,2646],{"class":407},"export PATH=\"/usr/local/bin:/usr/bin:/bin:$PATH\"\n",[390,2648,2649],{"class":392,"line":1662},[390,2650,481],{"emptyLinePlaceholder":480},[390,2652,2653],{"class":392,"line":1668},[390,2654,2655],{"class":407},"# Resolve Node/npm global prefix bin without relying on interactive shells\n",[390,2657,2658],{"class":392,"line":1673},[390,2659,2660],{"class":407},"PREFIX_BIN=\"\"\n",[390,2662,2663],{"class":392,"line":1685},[390,2664,2665],{"class":407},"if command -v npm >/dev/null 2>&1; then\n",[390,2667,2668],{"class":392,"line":1693},[390,2669,2670],{"class":407},"  PREFIX_BIN=\"$(npm config get prefix 2>/dev/null)/bin\"\n",[390,2672,2673],{"class":392,"line":1704},[390,2674,2675],{"class":407},"elif [ -d \"$HOME/.local/share/fnm/node-versions\" ]; then\n",[390,2677,2678],{"class":392,"line":1715},[390,2679,2680],{"class":407},"  # Fallback: pick the newest installed node version directory\n",[390,2682,2683],{"class":392,"line":1724},[390,2684,2685],{"class":407},"  LATEST_NODE_DIR=\"$(ls -1dt \"$HOME/.local/share/fnm/node-versions\"/*/installation 2>/dev/null | head -n 1 || true)\"\n",[390,2687,2688],{"class":392,"line":1730},[390,2689,2690],{"class":407},"  [ -n \"$LATEST_NODE_DIR\" ] && PREFIX_BIN=\"$LATEST_NODE_DIR/bin\"\n",[390,2692,2693],{"class":392,"line":1736},[390,2694,2290],{"class":407},[390,2696,2697],{"class":392,"line":1741},[390,2698,2699],{"class":407},"[ -z \"$PREFIX_BIN\" ] && PREFIX_BIN=\"/usr/local/bin\"\n",[390,2701,2702],{"class":392,"line":1753},[390,2703,2704],{"class":407},"export PATH=\"$PREFIX_BIN:$PATH\"\n",[390,2706,2707],{"class":392,"line":1760},[390,2708,481],{"emptyLinePlaceholder":480},[390,2710,2711],{"class":392,"line":1771},[390,2712,2713],{"class":407},"echo \"[remote] prefix bin: $PREFIX_BIN\"\n",[390,2715,2716],{"class":392,"line":1780},[390,2717,481],{"emptyLinePlaceholder":480},[390,2719,2720],{"class":392,"line":1789},[390,2721,2722],{"class":407},"# Locate pm2\n",[390,2724,2725],{"class":392,"line":1800},[390,2726,2727],{"class":407},"PM2_BIN=\"$(command -v pm2 || true)\"\n",[390,2729,2730],{"class":392,"line":1811},[390,2731,2732],{"class":407},"if [ -z \"$PM2_BIN\" ]; then\n",[390,2734,2735],{"class":392,"line":1820},[390,2736,2737],{"class":407},"  echo \"[remote] pm2 not found\" >&2\n",[390,2739,2740],{"class":392,"line":1826},[390,2741,2742],{"class":407},"  exit 127\n",[390,2744,2745],{"class":392,"line":1831},[390,2746,2290],{"class":407},[390,2748,2749],{"class":392,"line":1843},[390,2750,481],{"emptyLinePlaceholder":480},[390,2752,2753],{"class":392,"line":1853},[390,2754,2755],{"class":407},"echo \"[remote] using pm2: $PM2_BIN\"\n",[390,2757,2758],{"class":392,"line":1860},[390,2759,481],{"emptyLinePlaceholder":480},[390,2761,2762],{"class":392,"line":1871},[390,2763,2764],{"class":407},"cd \"${DEPLOY_DIR}\"\n",[390,2766,2767],{"class":392,"line":1882},[390,2768,2769],{"class":407},"mkdir -p .pm2\n",[390,2771,2772],{"class":392,"line":1893},[390,2773,481],{"emptyLinePlaceholder":480},[390,2775,2776],{"class":392,"line":1903},[390,2777,2778],{"class":407},"echo \"[remote] PM2 operation for $PM2_APP_NAME...\"\n",[390,2780,2782],{"class":392,"line":2781},72,[390,2783,2784],{"class":407},"if \"$PM2_BIN\" describe \"$PM2_APP_NAME\" >/dev/null 2>&1; then\n",[390,2786,2788],{"class":392,"line":2787},73,[390,2789,2790],{"class":407},"  \"$PM2_BIN\" reload \"$PM2_APP_NAME\" --update-env\n",[390,2792,2794],{"class":392,"line":2793},74,[390,2795,2796],{"class":407},"else\n",[390,2798,2800],{"class":392,"line":2799},75,[390,2801,2802],{"class":407},"  PM2_APP_NAME=\"$PM2_APP_NAME\" \"$PM2_BIN\" start ecosystem.config.cjs\n",[390,2804,2806],{"class":392,"line":2805},76,[390,2807,2808],{"class":407},"  \"$PM2_BIN\" save\n",[390,2810,2812],{"class":392,"line":2811},77,[390,2813,2290],{"class":407},[390,2815,2817],{"class":392,"line":2816},78,[390,2818,481],{"emptyLinePlaceholder":480},[390,2820,2822],{"class":392,"line":2821},79,[390,2823,2824],{"class":407},"\"$PM2_BIN\" status | cat\n",[390,2826,2828],{"class":392,"line":2827},80,[390,2829,2830],{"class":2626},"REMOTE_EOF\n",[390,2832,2834],{"class":392,"line":2833},81,[390,2835,481],{"emptyLinePlaceholder":480},[390,2837,2839,2841,2843,2846],{"class":392,"line":2838},82,[390,2840,2052],{"class":1931},[390,2842,781],{"class":780},[390,2844,2845],{"class":407},"[deploy] Completed",[390,2847,787],{"class":780},[296,2849,2851],{"id":2850},"nuxt-本地调试脚本","Nuxt 本地调试脚本",[336,2853,2854,2857,2858,2861],{},[317,2855,2856],{},"package.json"," 增加 ",[317,2859,2860],{},"start"," 便于本地/服务调试：",[381,2863,2867],{"className":2864,"code":2865,"filename":2856,"language":2866,"meta":386,"style":386},"language-json shiki shiki-themes material-theme-lighter github-light github-dark monokai","{\n  \"scripts\": {\n    \"start\": \"node .output/server/index.mjs\"\n  }\n}\n","json",[317,2868,2869,2874,2889,2909,2914],{"__ignoreMap":386},[390,2870,2871],{"class":392,"line":393},[390,2872,2873],{"class":736},"{\n",[390,2875,2876,2879,2883,2885,2887],{"class":392,"line":400},[390,2877,2878],{"class":982},"  \"",[390,2880,2882],{"class":2881},"sEff5","scripts",[390,2884,852],{"class":982},[390,2886,752],{"class":736},[390,2888,996],{"class":736},[390,2890,2891,2894,2897,2899,2901,2904,2907],{"class":392,"line":418},[390,2892,2893],{"class":982},"    \"",[390,2895,2860],{"class":2896},"s_MOj",[390,2898,852],{"class":982},[390,2900,752],{"class":736},[390,2902,781],{"class":2903},"sh1VR",[390,2905,341],{"class":2906},"sINAO",[390,2908,787],{"class":2903},[390,2910,2911],{"class":392,"line":424},[390,2912,2913],{"class":736},"  }\n",[390,2915,2916],{"class":392,"line":433},[390,2917,932],{"class":736},[296,2919,2920],{"id":2920},"提交站点地图",[374,2922,2924],{"to":2923},"https://nuxtseo.com/docs/sitemap/guides/submitting-sitemap",[336,2925,2926],{},"参考 SEO 指南（站点地图提交）",[336,2928,2929,2930,2933,2934],{},"首先确保站点地图已生成，并上传到 ",[317,2931,2932],{},"./public/sitemap.xml"," 目录下。例如：",[2935,2936,2940],"a",{"href":2937,"rel":2938},"https://mhaibaraai.cn/sitemap.xml",[2939],"nofollow",[317,2941,2937],{},[336,2943,2944],{},[448,2945],{"alt":2946,"src":2947},"站点地图","/images/ecosystem/nuxt/sitemap.png",[296,2949,2950],{"id":2950},"验证与排错",[300,2952,2953,2960,2967],{},[303,2954,2955,2956,2959],{},"容器内验证：",[317,2957,2958],{},"curl -I http://host.docker.internal:3000"," 应返回 200。",[303,2961,2962,2963,2966],{},"通过域名访问页面，关注 ",[317,2964,2965],{},"pm2 logs"," 与 Nginx 访问/错误日志。",[303,2968,2969,2970,2973],{},"若出现 ",[317,2971,2972],{},"better-sqlite3"," ABI 不匹配，确保在目标机上重新安装与构建（见项目的 Nuxt 踩坑笔记）。",[374,2975,2977],{"to":2976},"https://nuxt.com/docs/4.x/getting-started/deployment#cdn-proxy",[336,2978,2979],{},"如果经 Cloudflare，确保关闭 Rocket Loader/Mirage/Email Obfuscation，防止注入脚本引发水合异常。",[2981,2982,2983],"style",{},"html .light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html.light .shiki span {color: var(--shiki-light);background: var(--shiki-light-bg);font-style: var(--shiki-light-font-style);font-weight: var(--shiki-light-font-weight);text-decoration: var(--shiki-light-text-decoration);}html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html .sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html.sepia .shiki span {color: var(--shiki-sepia);background: var(--shiki-sepia-bg);font-style: var(--shiki-sepia-font-style);font-weight: var(--shiki-sepia-font-weight);text-decoration: var(--shiki-sepia-text-decoration);}html pre.shiki code .ss7Ak, html code.shiki .ss7Ak{--shiki-light:#90A4AE;--shiki-light-font-style:italic;--shiki-default:#6A737D;--shiki-default-font-style:inherit;--shiki-dark:#6A737D;--shiki-dark-font-style:inherit;--shiki-sepia:#88846F;--shiki-sepia-font-style:inherit}html pre.shiki code .sR7ES, html code.shiki .sR7ES{--shiki-light:#E2931D;--shiki-default:#6F42C1;--shiki-dark:#B392F0;--shiki-sepia:#A6E22E}html pre.shiki code .sLACW, html code.shiki .sLACW{--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74}html pre.shiki code .sFhLe, html code.shiki .sFhLe{--shiki-light:#91B859;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF}html pre.shiki code .ss--_, html code.shiki .ss--_{--shiki-light:#90A4AE;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2}html pre.shiki code .sHsBP, html code.shiki .sHsBP{--shiki-light:#E53935;--shiki-default:#22863A;--shiki-dark:#85E89D;--shiki-sepia:#F92672}html pre.shiki code .swvn1, html code.shiki .swvn1{--shiki-light:#39ADB5;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2}html pre.shiki code .siCPE, html code.shiki .siCPE{--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#E6DB74}html pre.shiki code .saDeg, html code.shiki .saDeg{--shiki-light:#39ADB5;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic}html pre.shiki code .sGXK2, html code.shiki .sGXK2{--shiki-light:#39ADB5;--shiki-default:#D73A49;--shiki-dark:#F97583;--shiki-sepia:#F92672}html pre.shiki code .squCx, html code.shiki .squCx{--shiki-light:#E53935;--shiki-default:#24292E;--shiki-dark:#E1E4E8;--shiki-sepia:#F8F8F2}html pre.shiki code .s8HiA, html code.shiki .s8HiA{--shiki-light:#FF5370;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF}html pre.shiki code .sYThS, html code.shiki .sYThS{--shiki-light:#F76D47;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#AE81FF}html pre.shiki code .sRxSC, html code.shiki .sRxSC{--shiki-light:#39ADB5;--shiki-light-font-style:italic;--shiki-default:#D73A49;--shiki-default-font-style:inherit;--shiki-dark:#F97583;--shiki-dark-font-style:inherit;--shiki-sepia:#F92672;--shiki-sepia-font-style:inherit}html pre.shiki code .sMLJd, html code.shiki .sMLJd{--shiki-light:#6182B8;--shiki-default:#005CC5;--shiki-dark:#79B8FF;--shiki-sepia:#66D9EF}html pre.shiki code .s00De, html code.shiki .s00De{--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#F8F8F2}html pre.shiki code .sEff5, html code.shiki .sEff5{--shiki-light:#9C3EDA;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic}html pre.shiki code .s_MOj, html code.shiki .s_MOj{--shiki-light:#E2931D;--shiki-light-font-style:inherit;--shiki-default:#005CC5;--shiki-default-font-style:inherit;--shiki-dark:#79B8FF;--shiki-dark-font-style:inherit;--shiki-sepia:#66D9EF;--shiki-sepia-font-style:italic}html pre.shiki code .sh1VR, html code.shiki .sh1VR{--shiki-light:#39ADB5;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2}html pre.shiki code .sINAO, html code.shiki .sINAO{--shiki-light:#91B859;--shiki-default:#032F62;--shiki-dark:#9ECBFF;--shiki-sepia:#CFCFC2}",{"title":386,"searchDepth":400,"depth":400,"links":2985},[2986,2987,2993,2994,2995,2996,2997,2998],{"id":298,"depth":400,"text":298},{"id":363,"depth":400,"text":363,"children":2988},[2989,2990,2991,2992],{"id":371,"depth":418,"text":372},{"id":454,"depth":418,"text":455},{"id":496,"depth":418,"text":497},{"id":651,"depth":418,"text":652},{"id":707,"depth":400,"text":708},{"id":963,"depth":400,"text":964},{"id":1265,"depth":400,"text":1266},{"id":2850,"depth":400,"text":2851},{"id":2920,"depth":400,"text":2920},{"id":2950,"depth":400,"text":2950},"md",null,{},{"title":114,"description":117},{"loc":115},"csGXDYfel9ecbNhwTgJ3kegc_w2ykV4U0I7hI5muI0w",[3006,3007],{"title":109,"path":110,"stem":111,"description":112,"children":-1},{"title":126,"path":127,"stem":128,"description":129,"children":-1},1756113721324]