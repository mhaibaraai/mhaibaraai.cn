import{useStorage as $}from"@vueuse/core";import{z as y}from"zod/v4";const x=y.enum(["localStorage","sessionStorage"]);function A(e){return y.object({key:y.string().min(1,{message:"Key cannot be empty"}),schema:y.custom(t=>t instanceof y.ZodType,{message:"Schema must be a valid Zod schema"}),defaultValue:y.custom(t=>e.safeParse(t).success,{message:"Default value must match the provided schema"}),prefix:y.string().default("movk"),storage:x.default("localStorage")})}function k(e){const t=A(e.schema).parse(e),{key:n,defaultValue:r,schema:o,storage:s,prefix:a}=t,i=`${a}:${n}`,c=(()=>{if(!(typeof window>"u"))return s==="localStorage"?localStorage:sessionStorage})();function l(p){if(p===null)return r;try{const g=JSON.parse(p),w=o.safeParse(g);return w.success?w.data:(console.warn(`[AppStorage] Validation failed for key "${i}". Using default value.`,w.error.issues),r)}catch(g){return console.warn(`[AppStorage] Failed to parse value for key "${i}". Using default value.`,g),r}}const u=$(i,r,c,{mergeDefaults:!0,serializer:{read:l,write:p=>JSON.stringify(p)}});function d(){if(!c)return r;const p=c.getItem(i);return l(p)}function h(p){const g=o.safeParse(p);if(!g.success){console.warn(`[AppStorage] Invalid value for key "${i}". Aborting setItem.`,g.error.issues);return}u.value=g.data}function f(){c&&(u.value=null)}return{state:u,getItem:d,setItem:h,removeItem:f}}async function O(e){if(typeof e!="string")throw new TypeError("Text must be a string");if(typeof window>"u")return console.warn("useCopyCode: Not available in server environment"),!1;if(navigator.clipboard&&window.isSecureContext)try{return await navigator.clipboard.writeText(e),!0}catch(t){console.warn("Clipboard API failed, falling back to legacy method:",t)}try{return I(e)}catch(t){return console.error("Failed to copy text:",t),!1}}function I(e){if(typeof document>"u")return console.warn("copyTextLegacy: Document not available"),!1;const t=document.createElement("textarea"),n=document.activeElement,r=document.getSelection(),o=r&&r.rangeCount>0?r.getRangeAt(0):null;try{return t.value=e,t.setAttribute("readonly",""),t.setAttribute("contenteditable","true"),Object.assign(t.style,{contain:"strict",position:"absolute",left:"-9999px",top:"-9999px",fontSize:"12pt",border:"0",padding:"0",margin:"0",outline:"none",boxShadow:"none",background:"transparent"}),document.body.appendChild(t),t.focus(),t.select(),t.setSelectionRange&&t.setSelectionRange(0,e.length),document.execCommand("copy")}catch(s){return console.error("Legacy copy method failed:",s),!1}finally{t.parentNode&&document.body.removeChild(t),o&&r&&(r.removeAllRanges(),r.addRange(o)),n instanceof HTMLElement&&n.focus()}}const m=y.object({id:y.string().default("id"),pid:y.string().default("pid"),children:y.string().default("children")});y.object({total:y.number().int().nonnegative(),leaves:y.number().int().nonnegative(),depth:y.number().int().nonnegative(),branches:y.number().int().nonnegative()});class b{static*dfsGenerator(t,n={},r=[]){const{children:o}=m.parse(n);let s=0;for(const a of t){const i=[...r,a];yield{node:a,path:i,depth:r.length,index:s++};const c=a[o];c&&c.length>0&&(yield*b.dfsGenerator(c,n,i))}}static*bfsGenerator(t,n={}){const{children:r}=m.parse(n),o=t.map((a,i)=>({node:a,path:[a],depth:0,index:i}));let s=t.length;for(;o.length>0;){const a=o.shift();yield a;const i=a.node[r];i&&i.length>0&&i.forEach(c=>{const l=[...a.path,c];o.push({node:c,path:l,depth:a.depth+1,index:s++})})}}static selectStrategy(t){switch(t){case"find":case"findAll":case"filter":case"transform":case"forEach":case"stats":case"validate":return"dfs";default:return"dfs"}}static fromList(t,n={}){const r=m.parse(n),{id:o,pid:s,children:a}=r;if(!Array.isArray(t)||t.length===0)return[];const i=new Map,c=[];return t.forEach(l=>{const u={...l,[a]:[]};i.set(l[o],u)}),t.forEach(l=>{const u=i.get(l[o]),d=l[s];d&&i.has(d)?i.get(d)[a].push(u):c.push(u)}),c}static toList(t,n={}){const r=m.parse(n),{children:o}=r,s=[],a=Array.isArray(t)?t:[t],i=c=>{const{[o]:l,...u}=c;s.push(u),l&&l.length>0&&l.forEach(i)};return a.forEach(i),s}static estimateSize(t,n={}){const r=m.parse(n),{children:o}=r,s=Array.isArray(t)?t:[t];let a=0;const i=c=>{a++;const l=c[o];l&&l.length>0&&l.forEach(i)};return s.forEach(i),a}static find(t,n,r={}){const o=Array.isArray(t)?t:[t],s=b.selectStrategy("find")==="dfs"?b.dfsGenerator(o,r):b.bfsGenerator(o,r);for(const a of s)if(n(a.node,a.depth,a.path))return a}static findAll(t,n,r={}){const o=Array.isArray(t)?t:[t],s=b.selectStrategy("findAll"),a=[],i=s==="dfs"?b.dfsGenerator(o,r):b.bfsGenerator(o,r);for(const c of i)n(c.node,c.depth,c.path)&&a.push(c);return a}static findById(t,n,r={}){const o=m.parse(r),{id:s}=o;return this.find(t,a=>a[s]===n,r)}static getStats(t,n={}){const r=m.parse(n),{children:o}=r,s=Array.isArray(t)?t:[t];let a=0,i=0,c=0,l=0;const u=(d,h)=>{a++,c=Math.max(c,h);const f=d[o];f&&f.length>0?(l++,f.forEach(p=>u(p,h+1))):i++};return s.forEach(d=>u(d,1)),{total:a,leaves:i,depth:c,branches:l}}static filter(t,n,r={}){const o=m.parse(r),{children:s}=o,a=Array.isArray(t)?t:[t],i=[],c=(l,u,d)=>{const h=l[s],f=[];if(h&&h.length>0){const p=[...d,l];h.forEach(g=>{const w=c(g,u+1,p);w&&f.push(w)})}return n(l,u,d)||f.length>0?{...l,[s]:f}:null};return a.forEach(l=>{const u=c(l,0,[]);u&&i.push(u)}),i}static transform(t,n,r={}){const o=m.parse(r),{children:s}=o,a=Array.isArray(t)?t:[t],i=[],c=(l,u,d)=>{const h=l[s],f=[];if(h&&h.length>0){const p=[...d,l];h.forEach(g=>{f.push(c(g,u+1,p))})}return{...n(l,u,d),[s]:f}};return a.forEach(l=>{i.push(c(l,0,[]))}),i}static forEach(t,n,r={}){const o=m.parse(r),{children:s}=o,a=Array.isArray(t)?t:[t],i=(c,l,u)=>{if(n(c,l,u)!==!1){const d=c[s];if(d&&d.length>0){const h=[...u,c];d.forEach(f=>{i(f,l+1,h)})}}};a.forEach(c=>i(c,0,[]))}static insertBefore(t,n,r,o={}){const s=m.parse(o),{id:a,children:i}=s,c={...r,[i]:[]},l=(u,d)=>{for(let h=0;h<u.length;h++){const f=u[h];if(f[a]===n)return u.splice(h,0,c),!0;const p=f[i];if(p&&p.length>0){const g=[...d,f];if(l(p,g))return!0}}return!1};return l(t,[])}static insertAfter(t,n,r,o={}){const s=m.parse(o),{id:a,children:i}=s,c={...r,[i]:[]},l=(u,d)=>{for(let h=0;h<u.length;h++){const f=u[h];if(f[a]===n)return u.splice(h+1,0,c),!0;const p=f[i];if(p&&p.length>0){const g=[...d,f];if(l(p,g))return!0}}return!1};return l(t,[])}static remove(t,n,r={}){const o=m.parse(r),{id:s,children:a}=o,i=c=>{for(let l=0;l<c.length;l++){const u=c[l];if(u[s]===n)return c.splice(l,1)[0];const d=u[a];if(d&&d.length>0){const h=i(d);if(h)return h}}};return i(t)}static validate(t,n={}){const r=m.parse(n),{id:o,children:s}=r,a=Array.isArray(t)?t:[t],i=[],c=new Set,l=(u,d,h)=>{const f=u[o];if(!f||typeof f!="string"){i.push(`Node at depth ${d} has invalid or missing ID`);return}if(c.has(f)){i.push(`Duplicate ID found: ${f}`);return}if(c.add(f),h.some(g=>g[o]===f)){i.push(`Circular reference detected for ID: ${f}`);return}const p=u[s];if(p!==void 0&&!Array.isArray(p)){i.push(`Node ${f} has invalid children property (not an array)`);return}if(p&&p.length>0){const g=[...h,u];p.forEach(w=>{l(w,d+1,g)})}};return a.forEach(u=>l(u,0,[])),{isValid:i.length===0,errors:i}}}function G(e){return[...new Set(e)]}function N(e,t){const n=[];for(let r=0;r<e.length;r+=t)n.push(e.slice(r,r+t));return n}function T(e,t=1){return t===1?e.flat():e.flat(t)}function D(e,t){let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>e(...r),t)}}function F(e){return new Promise(t=>setTimeout(t,e))}function P(e){let t,n;return{promise:new Promise((r,o)=>{n=o,t=setTimeout(r,e)}),cancel:()=>{clearTimeout(t),n(new Error("Sleep was cancelled"))}}}function M(e,t){let n=!1;return function(...r){n||(e.apply(this,r),n=!0,setTimeout(()=>{n=!1},t))}}async function U(e){if(!e||typeof e!="string")throw new Error("Invalid SVG string provided");if(typeof window>"u"||typeof document>"u")throw new TypeError("convertSvgToPng is only available in browser environment");return new Promise((t,n)=>{const r=new Image,o=document.createElement("canvas"),s=o.getContext("2d");if(!s){n(new Error("Canvas context not available"));return}r.onload=()=>{try{o.width=r.width,o.height=r.height,s.drawImage(r,0,0),o.toBlob(a=>{a?t(a):n(new Error("Failed to convert canvas to Blob"))},"image/png")}catch(a){n(new Error(`Error during canvas conversion: ${a}`))}},r.onerror=()=>{n(new Error("Failed to load SVG image"))};try{r.src=`data:image/svg+xml;base64,${btoa(e)}`}catch(a){n(new Error(`Failed to encode SVG: ${a}`))}})}function L(e,t="file"){if(!e)return t;const n=e.get("content-disposition");if(n){const r=n.match(/filename\*?=['"]?([^'";]+)['"]?/i);if(r){let o=r[1];if(n.includes("filename*=")){const s=o.split("''");s.length===2&&(o=decodeURIComponent(s[1]))}return o}}return t}function V(e,t){if(typeof window>"u"||typeof document>"u"){console.warn("triggerDownload: Not available in server environment");return}const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}function z(e){if(!Number.isFinite(e)||e<0||e===0)return"0 Bytes";const t=1024,n=["Bytes","KB","MB","GB","TB","PB"],r=Math.floor(Math.log(e)/Math.log(t));return r>=n.length?`${Number.parseFloat((e/t**(n.length-1)).toFixed(2))} ${n[n.length-1]}`:`${Number.parseFloat((e/t**r).toFixed(2))} ${n[r]}`}async function B(e,t){if(!e||typeof e!="string")throw new Error("Invalid SVG path provided");try{const n=await fetch(e);if(!n.ok)throw new Error(`Failed to fetch SVG file: ${n.status} ${n.statusText}`);const r=await n.text();if(!t)return r;if(typeof window>"u"||typeof DOMParser>"u")return console.warn("replaceCurrentColor: DOM manipulation not available in server environment, returning original SVG"),r;const o=new DOMParser().parseFromString(r,"image/svg+xml");if(o.querySelector("parsererror"))throw new Error("Invalid SVG content");const s=o.querySelector("svg");if(!s)throw new Error("No SVG element found in the document");s.hasAttribute("fill")||s.setAttribute("fill","currentColor");const a=i=>{i.getAttribute("fill")==="currentColor"&&i.setAttribute("fill",t),i.getAttribute("stroke")==="currentColor"&&i.setAttribute("stroke",t),Array.from(i.children).forEach(c=>{a(c)})};return a(s),new XMLSerializer().serializeToString(o)}catch(n){throw n instanceof Error?n:new Error(`Unexpected error occurred: ${n}`)}}function S(e,t=!1){if(!e||typeof e!="object"||Array.isArray(e))return e;const n=o=>o.replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase(),r={};for(const o in e)if(Object.prototype.hasOwnProperty.call(e,o)){const s=n(o),a=e[o];t&&a&&typeof a=="object"&&!Array.isArray(a)?r[s]=S(a,!0):r[s]=a}return r}function v(e){if(e===null||typeof e!="object")return e;if(e instanceof Date)return new Date(e.getTime());if(Array.isArray(e))return e.map(t=>v(t));if(typeof e=="object"){const t={};for(const n in e)t[n]=v(e[n]);return t}return e}function R(e,t){if(!e||typeof e!="object")return{};const n=new Set(t),r={};for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&!n.has(o)&&(r[o]=e[o]);return r}function K(e){return!e||typeof e!="object"||Array.isArray(e)?e:Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}function Z(e,t){if(!e||typeof e!="object")return{};const n={};for(const r of t)Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}function q(e,t){if(!e||typeof e!="object")return{picked:{},omitted:{}};if(t.length===0)return{picked:{},omitted:{...e}};const n=new Set(t),r={},o={};for(const s in e)if(Object.hasOwn(e,s)){const a=s;n.has(a)?r[s]=e[a]:o[s]=e[a]}return{picked:r,omitted:o}}function H(e){return e.charAt(0).toUpperCase()+e.slice(1)}function J(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function W(e){return e.replace(/-([a-z])/g,(t,n)=>n.toUpperCase())}function X(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t=(t<<5)-t+r,t=t&t}return Math.abs(t).toString(36)}function Q(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function E(e){return e!==null&&typeof e=="object"&&!Array.isArray(e)}function C(e){return Array.isArray(e)}function j(e){return typeof e=="string"}function Y(e){return typeof e=="number"&&!Number.isNaN(e)}function _(e){return typeof e=="function"}function tt(e){return e==null?!0:C(e)||j(e)?e.length===0:E(e)?Object.keys(e).length===0:!1}export{x as StorageTypeSchema,b as Tree,J as camelToKebab,H as capitalize,N as chunk,U as convertSvgToPng,S as convertToKebabCase,A as createStorageConfigSchema,D as debounce,v as deepClone,L as extractFilename,T as flatten,z as formatFileSize,Q as getRandomUUID,C as isArray,tt as isEmpty,_ as isFunction,Y as isNumber,E as isObject,j as isString,W as kebabToCamel,R as omit,K as omitUndefined,Z as pick,B as replaceCurrentColor,q as separate,X as simpleHash,F as sleep,P as sleepWithCancel,M as throttle,V as triggerDownload,G as unique,k as useAppStorage,O as useCopyCode};
